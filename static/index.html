<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Wine Quality Evaluator</title>
    <style>
        body {
            max-width: 600px;
            margin: 40px auto;
            font-family: sans-serif;
            line-height: 1.5;
        }

        .slider-group {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 5px;
        }

        label {
            width: 180px;
            display: inline-block;
        }

    </style>
</head>

<body>

    <h1>Wine Quality Evaluator</h1>

    <div id="sliders"></div>

    <h2>Predicted Quality: <span id="result"></span></h2>

    <script>

        // Feature definitions with ranges
        const FEATURES = [
            { key: "fixed_acidity", title: "Fixed Acidity", min: 4, max: 15, step: 0.1 },
            { key: "volatile_acidity", title: "Volatile Acidity", min: 0.1, max: 1.5, step: 0.01 },
            { key: "citric_acid", title: "Citric Acid", min: 0.0, max: 1.0, step: 0.01 },
            { key: "residual_sugar", title: "Residual Sugar", min: 0.5, max: 15, step: 0.1 },
            { key: "chlorides", title: "Chlorides", min: 0.01, max: 0.2, step: 0.001 },
            { key: "free_sulfur_dioxide", title: "Free SO₂", min: 0, max: 70, step: 1 },
            { key: "total_sulfur_dioxide", title: "Total SO₂", min: 0, max: 200, step: 1 },
            { key: "density", title: "Density", min: 0.9900, max: 1.0050, step: 0.0001 },
            { key: "pH", title: "pH", min: 2.5, max: 4.5, step: 0.01 },
            { key: "sulphates", title: "Sulphates", min: 0.2, max: 1.2, step: 0.01 },
            { key: "alcohol", title: "Alcohol (%)", min: 8, max: 15, step: 0.1 }
        ];

        let html = "";
        FEATURES.forEach(f => {
            const mid = (f.min + f.max) / 2;

            html += `
                <div class="slider-group">
                    <label for="${f.key}">${f.title}</label>
                    <input type="range"
                        id="${f.key}"
                        min="${f.min}"
                        max="${f.max}"
                        step="${f.step}"
                        value="${mid}">
                    <output id="${f.key}_out">${mid}</output>
                </div>
            `;
        });

        // Insert into page
        document.getElementById("sliders").innerHTML = html;

        // Update output values
        FEATURES.forEach(f => {
            const slider = document.getElementById(f.key);
            const out = document.getElementById(f.key + "_out");
            slider.addEventListener('input', () => out.textContent = slider.value);
            slider.addEventListener('change', evaluateWine);
        });

        // Handle Evaluate
        async function evaluateWine() {
            const data = {};

            FEATURES.forEach(f => {
                data[f.key] = parseFloat(document.getElementById(f.key).value);
            });

            try {
                const res = await fetch(`predict`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(data)
                });

                const json = await res.json();
                document.getElementById("result").textContent = json.predicted_quality;
            } catch {
                document.getElementById("result").textContent = "Error contacting API.";
            }
        };
    </script>

</body>

</html>